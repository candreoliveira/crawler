{
  "database": {
    "development": {
      "host": "127.0.0.1",
      "port": 27017,
      "name": "crawler",
      "user": "crawl",
      "password": "crawl",
      "engine": "mongo"
    },
    "importer2": {
      "host": "127.0.0.1",
      "port": 27017,
      "name": "crawler",
      "user": "crawl",
      "password": "crawl",
      "engine": "mysql",
      "block": 100,
      "query": {
        "count": "select count(*) as count from ",
        "block": "select url as url from "
      },
      "mapping": {
        "url": "url",
        "defaults": {
          "name": "item"
        }
      }
    }
  },
  "websites": [
    {
      "type": "headless",
      "name": "boadica",
      "domain": "https://www.boadica.com.br",
      "settings": {
        "lru": {
          "max": 1000
        },
        "retryDelay": 500,
        "retry": 5,
        "retryOnEmpty": 5,
        "parserOptions": {
          "headless": true,
          "devtools": false,
          "maxConnections": 1,
          "pages": 1,
          "retryCount": 5,
          "retryDelay": 500,
          "timeout": 10000
        }
      },
      "dependency": {
        "category": {
          "hasMany": "item",
          "through": "url",
          "type": "headless"
        },
        "item": {
          "hasMany": "seller",
          "through": "url",
          "type": "headless"
        }
      },
      "pages": [
        {
          "rootUrl": "/pesquisa/compu_notebook/precos?ClasseProdutoX=1&CodCategoriaX=2&XF=66",
          "name": "category",
          "nextPages": [
            {
              "selector": ".no-mobile .paginacao > a:not(.lnk_atual)",
              "attr": "href"
            }
          ],
          "data": [
            {
              "selector": ".row.preco.detalhe div:nth-child(4) a",
              "newKey": "url",
              "attr": "href"
            }
          ]
        },
        {
          "name": "item",
          "nextPages": null,
          "data": [
            {
              "selector": ".nome",
              "newKey": "name",
              "method": "text"
            },
            {
              "selector": ".tab-content #precos .row div:first-child .pull-left a",
              "newKey": "url",
              "attr": "href"
            }
          ]
        },
        {
          "name": "seller",
          "nextPages": null,
          "data": [
            {
              "selector": "body > p:nth-child(5) a",
              "newKey": "lat",
              "attr": "href",
              "replace": {
                "pattern": [".*lat=", "\\&.*"],
                "new": "",
                "options": "gi"
              }
            },
            {
              "selector": "body > p:nth-child(5) a",
              "newKey": "lng",
              "attr": "href",
              "replace": {
                "pattern": [".*lng=", "\\&.*"],
                "new": "",
                "options": "gi"
              }
            },
            {
              "join": ["lat", "lng"],
              "newKey": "coordinates",
              "list": true
            }
          ]
        }
      ]
    },
    {
      "type": "headless",
      "name": "magalu",
      "domain": "https://www.magazineluiza.com.br",
      "settings": {
        "lru": {
          "max": 1000
        },
        "retryDelay": 500,
        "retry": 5,
        "retryOnEmpty": 5,
        "parserOptions": {
          "userAgent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36",
          "headless": true,
          "devtools": false,
          "maxConnections": 5,
          "pages": 5
        }
      },
      "dependency": {
        "category": {
          "hasMany": "item",
          "through": "url",
          "type": "headless"
        }
      },
      "pages": [
        {
          "rootUrl": "/notebook-e-macbook/informatica/s/in/ntmk",
          "name": "category",
          "nextPages": [
            {
              "selector": "#showcase > ul:nth-child(6) li:not(.disabled):not(:first-child):not(:last-child) > a:not([aria-current='page'])",
              "method": "text",
              "param": "page"
            }
          ],
          "data": [
            {
              "selector": "#showcase > ul:nth-child(5) a[name='linkToProduct']",
              "newKey": "url",
              "attr": "href"
            }
          ]
        },
        {
          "name": "item",
          "nextPages": null,
          "preprocess": [
            {
              "type": "file",
              "path": "/home/carlosandre/Projects/crawler/src/parser/html/preprocess.headless.js"
            }
          ],
          "data": [
            {
              "selector": ".header-product__title",
              "newKey": "name",
              "method": "text"
            },
            {
              "selector": "#crawlerScriptResult .zipcode .table td:nth-child(1)",
              "newKey": "delivery",
              "method": "text"
            },
            {
              "selector": "#crawlerScriptResult .zipcode .table td:nth-child(2)",
              "newKey": "time",
              "method": "text",
              "replace": {
                "pattern": "(<[^>]*>?)|(\n)",
                "new": " ",
                "options": "gm"
              }
            },
            {
              "selector": "#crawlerScriptResult .zipcode .table td:nth-child(3)",
              "newKey": "shipping",
              "method": "text"
            },
            {
              "join": ["delivery", "time", "shipping"],
              "newKey": "freight",
              "list": true
            }
          ]
        }
      ]
    },
    {
      "type": "html",
      "name": "buscape",
      "domain": "https://www.buscape.com.br",
      "settings": {
        "lru": {
          "max": 1000
        },
        "retryDelay": 999,
        "retry": 5,
        "retryOnEmpty": 5,
        "parserOptions": {
          "userAgent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36",
          "headless": true,
          "devtools": false,
          "maxConnections": 5,
          "pages": 5,
          "retryTimeout": 100,
          "timeout": 5000,
          "retryDelay": 1000
        }
      },
      "pages": [
        {
          "rootUrl": "/sitemap-b.html",
          "name": "category",
          "nextPages": [
            {
              "selector": ".pagination a",
              "attr": "href"
            }
          ],
          "data": [
            {
              "selector": ".card--container > a",
              "newKey": "url",
              "attr": "href",
              "replace": {
                "pattern": "\\%",
                "options": "i",
                "new": ""
              }
            }
          ]
        }
      ]
    }
  ]
}
